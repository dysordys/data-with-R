<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to data analysis and visualization with R - 4&nbsp; Basic data manipulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Summaries_normalization.html" rel="next">
<link href="./Data_reading.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Basic data manipulation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to data analysis and visualization with R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_R_RStudio.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R and RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_programming_basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R programming basics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data_reading.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading tabular data from disk</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Basic_data_wrangling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Basic data manipulation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Summaries_normalization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summary statistics and tidy data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Creating_figures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Creating publication-grade figures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Further_plotting_options.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Some further plotting options; introducing factors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Joining_data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joining data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_statistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introducing statistical inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Kruskal–Wallis test and one-way ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Anova_two_way.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Two-way ANOVA and the Scheirer–Ray–Hare test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Linear_regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Nonlinear_regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">More general linear models; nonlinear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_map.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Higher-order functions and mapping</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Multiple_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Nested data and multiple analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#selecting-and-manipulating-data" id="toc-selecting-and-manipulating-data" class="nav-link active" data-scroll-target="#selecting-and-manipulating-data"><span class="toc-section-number">4.1</span>  Selecting and manipulating data</a>
  <ul class="collapse">
  <li><a href="#sec-select" id="toc-sec-select" class="nav-link" data-scroll-target="#sec-select"><span class="toc-section-number">4.1.1</span>  <code>select</code></a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="toc-section-number">4.1.2</span>  <code>filter</code></a></li>
  <li><a href="#slice" id="toc-slice" class="nav-link" data-scroll-target="#slice"><span class="toc-section-number">4.1.3</span>  <code>slice</code></a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"><span class="toc-section-number">4.1.4</span>  <code>arrange</code></a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate"><span class="toc-section-number">4.1.5</span>  <code>mutate</code></a></li>
  </ul></li>
  <li><a href="#using-pipes-to-our-advantage" id="toc-using-pipes-to-our-advantage" class="nav-link" data-scroll-target="#using-pipes-to-our-advantage"><span class="toc-section-number">4.2</span>  Using pipes to our advantage</a></li>
  <li><a href="#sec-wrangling-exercises" id="toc-sec-wrangling-exercises" class="nav-link" data-scroll-target="#sec-wrangling-exercises"><span class="toc-section-number">4.3</span>  Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-wrangling" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Basic data manipulation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="selecting-and-manipulating-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="selecting-and-manipulating-data"><span class="header-section-number">4.1</span> Selecting and manipulating data</h2>
<p>Let us start by loading <code>tidyverse</code>, in case you have not yet done so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<p>As you can see from the message output above, the <code>dplyr</code> package is part of <code>tidyverse</code>, which gets loaded by default. It allows one to arrange and manipulate data efficiently. The basic functions one should know are <code>rename</code>, <code>select</code>, <code>filter</code>, <code>slice</code>, <code>arrange</code>, and <code>mutate</code>. The first of these we have already looked at in <a href="Data_reading.html#sec-rename"><span>Section&nbsp;3.2.4</span></a>. Let us then see some examples of the latter ones. We load the <a href="https://raw.githubusercontent.com/dysordys/data-with-R/main/data/Goldberg2010_data.csv"><code>Goldberg2010_data.csv</code></a> data file we worked with in <a href="Data_reading.html"><span>Chapter&nbsp;3</span></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>goldbergDat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Goldberg2010_data.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(goldbergDat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                   Status
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Acnistus_arborescens           1
 2 Anisodus_tanguticus            1
 3 Atropa_belladonna              1
 4 Brachistus_stramonifolius      1
 5 Brugmansia_aurea               0
 6 Brugmansia_sanguinea           0
 7 Capsicum_annuum                1
 8 Capsicum_baccatum              1
 9 Capsicum_cardenasii            2
10 Capsicum_chacoense             1
# … with 346 more rows</code></pre>
</div>
</div>
<p>Now we will give examples of each of the functions <code>select</code>, <code>filter</code>, <code>slice</code>, <code>arrange</code>, and <code>mutate</code>. They are similar to our earlier <code>rename</code> in that the first argument they take is the data, in the form of a tibble. Their other arguments, and what they each do, are explained below.</p>
<section id="sec-select" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="sec-select"><span class="header-section-number">4.1.1</span> <code>select</code></h3>
<p>This function chooses <em>columns</em> of the data. The second and subsequent arguments of the function are the columns which should be retained. For example, <code>select(goldbergDat, Species)</code> will keep only the <code>Species</code> column of <code>goldbergDat</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Species                  
   &lt;chr&gt;                    
 1 Acnistus_arborescens     
 2 Anisodus_tanguticus      
 3 Atropa_belladonna        
 4 Brachistus_stramonifolius
 5 Brugmansia_aurea         
 6 Brugmansia_sanguinea     
 7 Capsicum_annuum          
 8 Capsicum_baccatum        
 9 Capsicum_cardenasii      
10 Capsicum_chacoense       
# … with 346 more rows</code></pre>
</div>
</div>
<p>It is also possible to deselect columns, by prepending a minus sign (<code>-</code>) in front of the column names. To drop the <code>Species</code> column, we can type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="sc">-</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Status
    &lt;dbl&gt;
 1      1
 2      1
 3      1
 4      1
 5      0
 6      0
 7      1
 8      1
 9      2
10      1
# … with 346 more rows</code></pre>
</div>
</div>
<p>Since there were only two columns in the data to begin with, only the <code>Status</code> column remained in the data after removing <code>Species</code>.</p>
<p>There are several other options within <code>select</code>, which mostly help with selecting several columns at a time fulfilling certain criteria. The collection of these options and methods is called <em>tidy selection</em>. A few examples follow. First, one can use logical operations to select columns. <code>select(goldbergDat, !Species)</code> means “select all columns that are not <code>Species</code>”. In this case, the only such column is <code>Status</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="sc">!</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Status
    &lt;dbl&gt;
 1      1
 2      1
 3      1
 4      1
 5      0
 6      0
 7      1
 8      1
 9      2
10      1
# … with 346 more rows</code></pre>
</div>
</div>
<p>One can also specify, as character strings, what the column names should start or end with, using <code>starts_with</code> and <code>ends_with</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="fu">starts_with</span>(<span class="st">"S"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                   Status
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Acnistus_arborescens           1
 2 Anisodus_tanguticus            1
 3 Atropa_belladonna              1
 4 Brachistus_stramonifolius      1
 5 Brugmansia_aurea               0
 6 Brugmansia_sanguinea           0
 7 Capsicum_annuum                1
 8 Capsicum_baccatum              1
 9 Capsicum_cardenasii            2
10 Capsicum_chacoense             1
# … with 346 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="fu">starts_with</span>(<span class="st">"Sp"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Species                  
   &lt;chr&gt;                    
 1 Acnistus_arborescens     
 2 Anisodus_tanguticus      
 3 Atropa_belladonna        
 4 Brachistus_stramonifolius
 5 Brugmansia_aurea         
 6 Brugmansia_sanguinea     
 7 Capsicum_annuum          
 8 Capsicum_baccatum        
 9 Capsicum_cardenasii      
10 Capsicum_chacoense       
# … with 346 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="fu">ends_with</span>(<span class="st">"s"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                   Status
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Acnistus_arborescens           1
 2 Anisodus_tanguticus            1
 3 Atropa_belladonna              1
 4 Brachistus_stramonifolius      1
 5 Brugmansia_aurea               0
 6 Brugmansia_sanguinea           0
 7 Capsicum_annuum                1
 8 Capsicum_baccatum              1
 9 Capsicum_cardenasii            2
10 Capsicum_chacoense             1
# … with 346 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="fu">ends_with</span>(<span class="st">"us"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Status
    &lt;dbl&gt;
 1      1
 2      1
 3      1
 4      1
 5      0
 6      0
 7      1
 8      1
 9      2
10      1
# … with 346 more rows</code></pre>
</div>
</div>
<p>Finally, the function <code>contains</code> can select columns which contain some string anywhere in their names:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(goldbergDat, <span class="fu">contains</span>(<span class="st">"tatu"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 1
   Status
    &lt;dbl&gt;
 1      1
 2      1
 3      1
 4      1
 5      0
 6      0
 7      1
 8      1
 9      2
10      1
# … with 346 more rows</code></pre>
</div>
</div>
</section>
<section id="filter" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="filter"><span class="header-section-number">4.1.2</span> <code>filter</code></h3>
<p>While <code>select</code> chooses columns, <code>filter</code> chooses rows from the data. As with all these functions, the first argument of <code>filter</code> is the data. The second argument is a logical condition on the columns. Those rows which satisfy the condition are retained; the rest are dropped. Thus, <code>filter</code> keeps only those rows of the data which fulfill some condition.</p>
<p>Recall that in the <code>Goldberg2010_data.csv</code> dataset, a <code>Status</code> of 0 means self-incompatibility; a <code>Status</code> of 1 means self-compatibility, and <code>Status</code> values between 2 and 5 refer to various, more complex selfing mechanisms. So in case we wanted to focus only on those species which exhibit complex selfing, we could <code>filter</code> the data like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(goldbergDat, Status <span class="sc">&gt;=</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 2
   Species               Status
   &lt;chr&gt;                  &lt;dbl&gt;
 1 Capsicum_cardenasii        2
 2 Capsicum_pubescens         2
 3 Dunalia_solanacea          4
 4 Lycium_arenicola           4
 5 Lycium_californicum        3
 6 Lycium_exsertum            4
 7 Lycium_fremontii           4
 8 Lycium_gariepense          4
 9 Lycium_horridum            4
10 Lycium_strandveldense      4
# … with 34 more rows</code></pre>
</div>
</div>
<p>The filtered data have only 44 rows, instead of the original 356—this is the number of species with more complex selfing mechanisms.</p>
</section>
<section id="slice" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="slice"><span class="header-section-number">4.1.3</span> <code>slice</code></h3>
<p>With <code>slice</code>, one can choose rows of the data, just like with <code>filter</code>. Unlike with <code>filter</code> however, <code>slice</code> receives a vector of row indices instead of a condition to be tested on each row. So, for example, if one wanted to keep only the first, second, and fifth rows, then one can do so with <code>slice</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice</span>(goldbergDat, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Species              Status
  &lt;chr&gt;                 &lt;dbl&gt;
1 Acnistus_arborescens      1
2 Anisodus_tanguticus       1
3 Brugmansia_aurea          0</code></pre>
</div>
</div>
<p>(Note: the numbers in front of the rows in the output generated by tibbles always pertain to the row numbers of the <em>current table</em>, not the one from which they were created. So the row labels <code>1</code>, <code>2</code>, and <code>3</code> above simply enumerate the rows of the sliced data. The actual rows still correspond to rows 1, 2, and 5 in the original <code>goldbergDat</code>.)</p>
</section>
<section id="arrange" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="arrange"><span class="header-section-number">4.1.4</span> <code>arrange</code></h3>
<p>This function rearranges the rows of the data, in increasing order of the column given as the second argument. For example, to arrange in increasing order of <code>Status</code>, we write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(goldbergDat, Status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                 Status
   &lt;chr&gt;                    &lt;dbl&gt;
 1 Brugmansia_aurea             0
 2 Brugmansia_sanguinea         0
 3 Cuatresia_exiguiflora        0
 4 Cuatresia_riparia            0
 5 Dunalia_brachyacantha        0
 6 Dyssochroma_viridiflora      0
 7 Eriolarynx_lorentzii         0
 8 Grabowskia_duplicata         0
 9 Iochroma_australe            0
10 Iochroma_cyaneum             0
# … with 346 more rows</code></pre>
</div>
</div>
<p>To arrange in decreasing order, apply the <code>desc</code> function to <code>Status</code> within <code>arrange</code>, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(goldbergDat, <span class="fu">desc</span>(Status))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species               Status
   &lt;chr&gt;                  &lt;dbl&gt;
 1 Solanum_wendlandii         5
 2 Dunalia_solanacea          4
 3 Lycium_arenicola           4
 4 Lycium_exsertum            4
 5 Lycium_fremontii           4
 6 Lycium_gariepense          4
 7 Lycium_horridum            4
 8 Lycium_strandveldense      4
 9 Lycium_tetrandrum          4
10 Lycium_villosum            4
# … with 346 more rows</code></pre>
</div>
</div>
<p>It is also perfectly possible to arrange by a column whose type is character string. In that case, the system will automagically sort the rows in alphabetical order—or reverse alphabetical order, in case <code>desc</code> is applied. For example, to sort in reverse alphabetical order of species binomials:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(goldbergDat, <span class="fu">desc</span>(Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                   Status
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Witheringia_solanacea          2
 2 Witheringia_mexicana           0
 3 Witheringia_meiantha           0
 4 Witheringia_macrantha          0
 5 Witheringia_cuneata            0
 6 Witheringia_coccoloboides      0
 7 Withania_somnifera             1
 8 Withania_coagulans             4
 9 Vassobia_breviflora            1
10 Symonanthus_bancroftii         4
# … with 346 more rows</code></pre>
</div>
</div>
<p>Notice that when we sorted the rows by <code>Status</code>, there are many ties—rows with the same value of <code>Status</code>. In those cases, <code>arrange</code> will not be able to decide which rows should come earlier, and so any ordering that was present before invoking <code>arrange</code> will be retained. In case we would like to break the ties, we can give further sorting variables, as the third, fourth, etc. arguments to <code>arrange</code>. To sort the data by <code>Status</code>, and to resolve ties in alphabetical order of <code>Species</code>, we write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(goldbergDat, Status, Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 2
   Species                 Status
   &lt;chr&gt;                    &lt;dbl&gt;
 1 Brugmansia_aurea             0
 2 Brugmansia_sanguinea         0
 3 Cuatresia_exiguiflora        0
 4 Cuatresia_riparia            0
 5 Dunalia_brachyacantha        0
 6 Dyssochroma_viridiflora      0
 7 Eriolarynx_lorentzii         0
 8 Grabowskia_duplicata         0
 9 Iochroma_australe            0
10 Iochroma_cyaneum             0
# … with 346 more rows</code></pre>
</div>
</div>
<p>This causes the table to be sorted primarily by <code>Status</code>, but in case there are ties (equal <code>Status</code> between multiple rows), they will be resolved in priority of alphabetical order—first those starting with “A” (if they exist), then “B”, and so on.</p>
</section>
<section id="mutate" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="mutate"><span class="header-section-number">4.1.5</span> <code>mutate</code></h3>
<p>The <code>mutate</code> function allows us to create new columns from existing ones. We may apply any function or operator we learned about to existing columns, and the result of the computation will go into the new column. We do this in the second argument of <code>mutate</code> (the first, as always, is the data), by first giving a name to the column, then writing <code>=</code>, and then the desired computation. For example, we may find it strange that the selfing status of the species is encoded with a number ranging from 0 to 5, instead of 1 to 6. This is easy to fix however, using <code>mutate</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(goldbergDat, <span class="at">NewStatus =</span> Status <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 3
   Species                   Status NewStatus
   &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;
 1 Acnistus_arborescens           1         2
 2 Anisodus_tanguticus            1         2
 3 Atropa_belladonna              1         2
 4 Brachistus_stramonifolius      1         2
 5 Brugmansia_aurea               0         1
 6 Brugmansia_sanguinea           0         1
 7 Capsicum_annuum                1         2
 8 Capsicum_baccatum              1         2
 9 Capsicum_cardenasii            2         3
10 Capsicum_chacoense             1         2
# … with 346 more rows</code></pre>
</div>
</div>
<p>The original columns of the data are retained, but we now also have the additional <code>NewStatus</code> column.</p>
<p>Perhaps more interestingly, we could create a new column indicating whether the selfing mechanism of the species is simple (<code>Status</code> either 0 or 1) or complex (<code>Status</code> between 2 and 5). We can do this using an <code>ifelse</code> function within <code>mutate</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(goldbergDat, <span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 3
   Species                   Status Selfing
   &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;  
 1 Acnistus_arborescens           1 simple 
 2 Anisodus_tanguticus            1 simple 
 3 Atropa_belladonna              1 simple 
 4 Brachistus_stramonifolius      1 simple 
 5 Brugmansia_aurea               0 simple 
 6 Brugmansia_sanguinea           0 simple 
 7 Capsicum_annuum                1 simple 
 8 Capsicum_baccatum              1 simple 
 9 Capsicum_cardenasii            2 complex
10 Capsicum_chacoense             1 simple 
# … with 346 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="using-pipes-to-our-advantage" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="using-pipes-to-our-advantage"><span class="header-section-number">4.2</span> Using pipes to our advantage</h2>
<p>When composing multiple <code>tidyverse</code> functions together, things can get unwieldy quite quickly. Let us take the same data, and create the new column <code>Selfing</code> as above. What happens if we then filter for only those entries with complex selfing mechanism, and finally, we select the column <code>Species</code> only? Here is the solution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(goldbergDat, <span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>)),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    Selfing <span class="sc">==</span> <span class="st">"complex"</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  Species</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 1
   Species              
   &lt;chr&gt;                
 1 Capsicum_cardenasii  
 2 Capsicum_pubescens   
 3 Dunalia_solanacea    
 4 Lycium_arenicola     
 5 Lycium_californicum  
 6 Lycium_exsertum      
 7 Lycium_fremontii     
 8 Lycium_gariepense    
 9 Lycium_horridum      
10 Lycium_strandveldense
# … with 34 more rows</code></pre>
</div>
</div>
<p>The expression is highly unpleasant: to a human reader, it is not at all obvious what is happening above. To clarify, we have two options. One is to rely on repeated assignment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mutatedDat <span class="ot">&lt;-</span> <span class="fu">mutate</span>(goldbergDat,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>filteredDat <span class="ot">&lt;-</span> <span class="fu">filter</span>(mutatedDat, Selfing <span class="sc">==</span> <span class="st">"complex"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>onlySpeciesDat <span class="ot">&lt;-</span> <span class="fu">select</span>(filteredDat, Species)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(onlySpeciesDat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 1
   Species              
   &lt;chr&gt;                
 1 Capsicum_cardenasii  
 2 Capsicum_pubescens   
 3 Dunalia_solanacea    
 4 Lycium_arenicola     
 5 Lycium_californicum  
 6 Lycium_exsertum      
 7 Lycium_fremontii     
 8 Lycium_gariepense    
 9 Lycium_horridum      
10 Lycium_strandveldense
# … with 34 more rows</code></pre>
</div>
</div>
<p>This, however, requires inventing arbitrary variable names at every step, or else overwriting variables. For such a short example, this is not problematic, but doing the same for a long pipeline of dozens of steps could get confusing, as well as dangerous due to the repeatedly modified variables.</p>
<p>It turns out that one can get the best of both worlds: the safety of function composition with the conceptual clarity of repeated assignments. This only requires that we make use of the pipe operator <code>%&gt;%</code> that we learned about in <a href="R_programming_basics.html#sec-pipes"><span>Section&nbsp;2.4.4</span></a>. As a reminder, for any function <code>f</code> and function argument <code>x</code>, <code>f(x, y, ...)</code> is the same as <code>x %&gt;% f(y, ...)</code>, where the <code>...</code> denote potential further arguments to <code>f</code>. That is, the first argument of the function can be moved from the argument list to in front of the function, before the pipe symbol. The <code>tidyverse</code> functions take the data as their first argument, which means that the use of pipes allow us to very conveniently chain together multiple steps of data analysis. In our case, we can rewrite the original and quite confusing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(goldbergDat, <span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>)),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    Selfing <span class="sc">==</span> <span class="st">"complex"</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  Species</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>with the use of pipes, in a much more transparent way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>goldbergDat <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Selfing <span class="sc">==</span> <span class="st">"complex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again, the pipe <code>%&gt;%</code> should be pronounced <em>then</em>. We take the data, <em>then</em> we mutate it, <em>then</em> we filter for complex selfing, and <em>then</em> we select one of the columns. In performing these steps, each function both receives and returns data. Thus, by starting out with the original <code>goldbergDat</code>, we no longer need to write out the data argument of the functions explicitly. Instead, the pipe takes care of that automatically for us, making the functions receive as their first input argument the piped-in data, and in turn producing transformed data as their output—which becomes the input for the next function in line.</p>
<p>In fact, there is technically no need to even assign <code>goldbergDat</code>. The pipe can just as well start with <code>read_csv</code> to import the dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"Goldberg2010_data.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Selfing =</span> <span class="fu">ifelse</span>(Status <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">"simple"</span>, <span class="st">"complex"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Selfing <span class="sc">==</span> <span class="st">"complex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 1
   Species              
   &lt;chr&gt;                
 1 Capsicum_cardenasii  
 2 Capsicum_pubescens   
 3 Dunalia_solanacea    
 4 Lycium_arenicola     
 5 Lycium_californicum  
 6 Lycium_exsertum      
 7 Lycium_fremontii     
 8 Lycium_gariepense    
 9 Lycium_horridum      
10 Lycium_strandveldense
# … with 34 more rows</code></pre>
</div>
</div>
</section>
<section id="sec-wrangling-exercises" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-wrangling-exercises"><span class="header-section-number">4.3</span> Exercises</h2>
<ol type="1">
<li>The <a href="https://raw.githubusercontent.com/dysordys/data-with-R/main/data/Smith2003_data.txt"><code>Smith2003_data.txt</code></a> dataset we worked with in <a href="Data_reading.html"><span>Chapter&nbsp;3</span></a> occasionally has the entry <code>-999</code> in its last three columns. This stands for unavailable data. In R, there is a built-in way of referring to such information: by setting a variable to <code>NA</code>. (So, for example, <code>x &lt;- NA</code> will set the variable <code>x</code> to <code>NA</code>.) Modify these columns (using <code>mutate</code>) so that the entries which are equal to <code>-999</code> are replaced with <code>NA</code>.</li>
<li>Remove all rows from the data which contain one or more <code>NA</code> values (hint: look up the function <code>drop_na</code>). How many rows are retained? And what was the original number of rows?</li>
</ol>
<p>The <code>iris</code> dataset is a built-in table in R. It contains measurements of petal and sepal characteristics from three flower species belonging to the genus <em>Iris</em> (<a href="https://en.wikipedia.org/wiki/Iris_setosa"><em>I. setosa</em></a>, <a href="https://en.wikipedia.org/wiki/Iris_versicolor"><em>I. versicolor</em></a>, and <a href="https://en.wikipedia.org/wiki/Iris_virginica"><em>I. virginica</em></a>). If you type <code>iris</code> in the console, you will see the dataset displayed. In solving the problems below, feel free to use the all-important <a href="https://btep.ccr.cancer.gov/docs/rintro/resources/dplyr_cheatsheet.pdf"><code>dplyr</code> cheat sheet</a>.</p>
<ol start="3" type="1">
<li>The format of the data is not a <code>tibble</code>, but a <code>data.frame</code>. As mentioned in the previous chapter, the two are basically the same for practical purposes, though internally, <code>tibble</code>s do offer some advantages. Convert the <code>iris</code> data frame into a tibble. (Hint: look up the <code>as_tibble</code> function.)</li>
<li>Select the columns containing petal and sepal length, and species identity.</li>
<li>Get those rows of the data with petal length less than 4 cm, but sepal length greater than 4 cm.</li>
<li>Sort the data by increasing petal length but decreasing sepal length.</li>
<li>Create a new column called <code>MeanLength</code>. It should contain the average of the petal and sepal length (i.e., petal length plus sepal length, divided by 2) of each individual flower.</li>
<li>Perform the operations from the previous two exercises in a single long function call using function composition via pipes.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Data_reading.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading tabular data from disk</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Summaries_normalization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Summary statistics and tidy data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>